### Climatic Driver of Symbiotic Nitrogen-fixing Tree Success in North America
### Wenying Liao
### New Model: no wind effect + Simplified Model
### 2016-02-07
################################################################
####################      Load in Libraries   ##################
################################################################
library(rjags)
library(R2jags)
library(fields) # for image.plot()
library(reshape) # for cast()
library(maps)
install.packages("R2jags")
install.packages("fields")
install.packages("maps")
install.packages("maps")
install.packages("boot")
install.packages("boot")
library(rjags)
library(R2jags)
library(fields) # for image.plot()
library(reshape) # for cast()
library(maps)
library(boot)
data(mexicoMapEnv)
setwd("C:/Users/Eleen/Dropbox/Drop_Box/Projects/CRU/Spring2016/Data")
BA_clm<-read.csv("CRU_All_BA_perc_clm10min_FinalwClimate_actvsriz_150312.csv")
BA_clm<-BA_clm[,c(-1)]
####################
#################### # Fixers
####################
### Model: dnrom, do not use zero- or one-inflated model
data <- BA_clm
n <- nrow(data)
mean_MAP <- mean(BA_clm$MAP)
mean_MAT <- mean(BA_clm$MAT)
MAT_x <- seq(-5,30,(30-5)/100)
MAP_x <- seq(0,410,(410-0)/100)
data=list(
n=n,
MAT=as.double(data$MAT),
MAP=as.double(data$MAP),
y=data$perc_fix_all,
MAT_x=MAT_x,
MAP_x=MAP_x
)
### MCMC Analysis
inits=list(list(a1=2,a2=1.9,int=0.01,sigma=0.1),list(a1=2,a2=-2,int=0.01,sigma=0.1),list(a1=2.1,a2=-1.8,int=0.1,sigma=0.1))
n.adapt=100
n.update=500
n.iter=100
setwd("C:/Users/Eleen/Dropbox/Drop_Box/Projects/CRU/Spring2016/Model")
dnorm_model_jags <- jags.model("CRU_model_dnorm_160207.R",data=data,inits,n.chains=length(inits),n.adapt=n.adapt)
update(dnorm_model_jags,n.iter=n.update)
setwd("C:/Users/Eleen/Dropbox/Drop_Box/Projects/CRU/Spring2016/Produced_Data")
all_model_stat <- read.csv("CRU_all_dnorm_model_stat_160208.csv",header=T)
all_model_stat <- all_model_stat[,c(-1)]
setwd("C:/Users/Eleen/Dropbox/Drop_Box/Projects/CRU/Spring2016/Stored_160207/Produced_Data")
dat_ba_mat_fix<-read.csv("CRU_dat_ba_mat_fix_160119.csv",header=T)
dat_ba_map_fix<-read.csv("CRU_dat_ba_map_fix_160119.csv",header=T)
dat_ba_mat_fix<-dat_ba_mat_fix[,c(-1)]
dat_ba_map_fix<-dat_ba_map_fix[,c(-1)]
BA_clm$fMAT<-floor(BA_clm$MAT)
BA_clm$fMAP<-floor(BA_clm$MAP/10)*10
ba_mean_mat_fix<-tapply(BA_clm$perc_fix_all,BA_clm$fMAT,mean)
ba_mat_fix<-as.data.frame(ba_mean_mat_fix)
ba_mat_fix$fMAT<-as.double(rownames(ba_mat_fix))
ba_mean_map_fix<-tapply(BA_clm$perc_fix_all,BA_clm$fMAP,mean)
ba_map_fix<-as.data.frame(ba_mean_map_fix)
ba_map_fix$fMAP<-as.double(rownames(ba_map_fix))
plot(ba_mat_fix$ba_mean_mat*100~ba_mat_fix$fMAT,cex=1,pch=19,col="grey",xlab=expression(paste("Mean Annual Temperature (",degree,"C)")),ylab="N Fixer Basal Area (%)",ylim=c(0,80),main="Temperature",xlim=c(-5,30))
points(medianfit_MAT*100~MAT_x,typ="l",lwd=2)
points(lowerfit_MAT*100~MAT_x,col="red",typ="l",lwd=2,lty=2)
points(upperfit_MAT*100~MAT_x,col="red",typ="l",lty=2,lwd=2)
legend("topright",col=c("grey","black","red"),legend=c("Mean BA% of Data","Best Fit of Data","95% CI of Best Fit"),lty=c(NA,1,2),pch=c(19,NA,NA),bty='n',lwd=2)
setwd("/Users/wenyingliao/Dropbox/Drop_Box/Projects/CRU/Spring2016/Model")
setwd("C:/Users/Eleen/Dropbox/Drop_Box/Projects/CRU/Spring2016/Model")
dnorm_model_jags <- jags.model("CRU_model_dnorm_160207.R",data=data,inits,n.chains=length(inits),n.adapt=n.adapt)
update(dnorm_model_jags,n.iter=n.update)
